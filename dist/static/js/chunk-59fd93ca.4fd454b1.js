(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59fd93ca"],{e625:function(t,e,a){},eda1:function(t,e,a){"use strict";var i=a("e625"),s=a.n(i);s.a},efad:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",[a("section",{directives:[{name:"loading",rawName:"v-loading",value:t.articleLoading,expression:"articleLoading"}],staticClass:"wrap scroll"},[a("el-form",{ref:"form",attrs:{"label-width":"70px","label-position":"left"},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[a("div",{staticClass:"leftbox"},[a("el-form-item",{attrs:{label:"文章标题"}},[a("el-input",{staticClass:"input_title",attrs:{size:"small"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("el-row",{attrs:{type:"flex"}},[a("el-form-item",{attrs:{label:"所属分类"}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.classify,callback:function(e){t.$set(t.form,"classify",e)},expression:"form.classify"}})],1),a("el-form-item",{attrs:{label:"标签"}},[a("el-input",{attrs:{size:"small",placeholder:"多个标签用英文逗号隔开"},model:{value:t.form.tags,callback:function(e){t.$set(t.form,"tags",e)},expression:"form.tags"}})],1)],1),a("el-row",{attrs:{type:"flex"}},[a("el-form-item",{attrs:{label:"创建日期"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",size:"small",placeholder:"选择日期"},model:{value:t.form.created_at,callback:function(e){t.$set(t.form,"created_at",e)},expression:"form.created_at"}})],1),a("el-form-item",{attrs:{label:"浏览量"}},[a("el-input-number",{attrs:{size:"small",precision:0,min:0,controls:!1},model:{value:t.form.clicks,callback:function(e){t.$set(t.form,"clicks",e)},expression:"form.clicks"}})],1),a("el-form-item",{attrs:{label:"点赞量"}},[a("el-input-number",{attrs:{size:"small",precision:0,min:0,controls:!1},model:{value:t.form.like,callback:function(e){t.$set(t.form,"like",e)},expression:"form.like"}})],1)],1)],1),a("div",{staticClass:"rightbox"},[a("el-form-item",{attrs:{label:"文章封面"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/v2/image/upload",name:"image",headers:t.headers,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.blogBanner?a("img",{staticClass:"avatar",attrs:{src:t.blogBanner}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)]),a("mavon-editor",{ref:"md",staticClass:"makedown",on:{imgAdd:t.$imgAdd,imgDel:t.$imgDel},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),a("footer",[t.$route.params.id?a("el-button",{attrs:{type:"info",size:"small",loading:t.loading},on:{click:t.editBtn}},[t._v("保存修改")]):a("el-button",{attrs:{type:"primary",size:"small",loading:t.loading},on:{click:t.addBtn}},[t._v("保　存")])],1)])},s=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),r=a("bc3a"),l=a.n(r),n=a("2f62");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={data:function(){return{title:"写博客",blogBanner:"",loading:!1,articleLoading:!1,form:{title:"",desc:"",img:"",content:"",classify:"",tags:"",clicks:"",like:"",deleted_at:!1,created_at:new Date}}},computed:m({},Object(n["c"])(["token"]),{headers:function(){return{Authorization:this.token,"X-Requested-With":"XMLHttpRequest"}}}),created:function(){this.$route.params.id&&this.getArticle()},watch:{$route:function(t,e){this.blogBanner="",this.form={title:"",desc:"",img:"",content:"",classify:"",tag:"",clicks:"",like:"",deleted_at:!1,created_at:new Date}}},methods:{addBtn:function(){var t=this;this.loading=!0,this.$post("/api/v2/article/add",this.form).then((function(e){t.$message.success(e.message),t.$router.push("/articlelist"),t.loading=!1})).catch((function(){t.loading=!1}))},getArticle:function(){var t=this;this.articleLoading=!0;var e={id:this.$route.params.id,all:1};this.$post("/api/v2/article",e).then((function(e){console.log(e.data),t.articleLoading=!1,t.form=e.data,t.form.tags=e.data.tags.join(","),t.form.img&&(t.blogBanner=t.$staticUrl+t.form.img)})).catch((function(){t.articleLoading=!1}))},editBtn:function(){var t=this;this.loading=!0,this.$post("/api/v2/article/edit",this.form).then((function(e){t.$message.success(e.message),t.$router.push("/articlelist"),t.loading=!1})).catch((function(){}))},handleAvatarSuccess:function(t,e){this.form.img&&this.handleRemove(),this.blogBanner=URL.createObjectURL(e.raw),this.$message.success("图片上传成功"),this.form.img=t.data.url},handleRemove:function(){var t=this,e={image:this.form.img};this.$post("/api/v2/image/titleDelete",e).then((function(e){t.$message.success(e.message)})).catch((function(){}))},beforeAvatarUpload:function(t){var e="image/jpeg"==t.type||"image/png",a=t.size/1024/1024<3;return e||this.$message.error("上传图片只能是 JPG和png 格式!"),a||this.$message.error("上传头像图片大小不能超过 3MB!"),e&&a},$imgAdd:function(t,e){var a=this,i=new FormData;i.append("image",e),l()({url:"/api/v2/image/upload",method:"post",data:i,headers:{Authorization:this.token,"X-Requested-With":"XMLHttpRequest"}}).then((function(i){console.log(111,i,i.data.data.url,e),a.$refs.md.$img2Url(t,a.$staticUrl+i.data.data.url)})).catch((function(){}))},$imgDel:function(t){var e=this;console.log(t,"图片名"),l()({url:"/api/v2/image/delete",method:"post",data:{image:t},headers:{Authorization:this.token,"X-Requested-With":"XMLHttpRequest"}}).then((function(a){console.log(111,a,a.data.data.url,$file),e.$refs.md.$img2Url(t,e.$staticUrl+a.data.data.url)})).catch((function(){}))}}},f=d,u=(a("eda1"),a("2877")),p=Object(u["a"])(f,i,s,!1,null,"c6925542",null);e["default"]=p.exports}}]);